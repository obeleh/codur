fix the bug, I think there is an off-by-one error in the code.